# -*- coding: utf-8 -*-
"""exploratory_data_analysis_diseases_small.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://github.com/paddydoc/paddy-doctor-dataset/blob/main/notebooks/exploratory_data_analysis_diseases_small.ipynb

### Paddy Doctor Dataset - Exploratory  Data Analysis
ack: https://www.kaggle.com/code/cheremgena/simple-cnn-problems-with-rare-classes
"""



import os
import glob
from pathlib import Path
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

#sns.set_theme(style="white")
#sns.set_style('white')
sns.set(font_scale=1.2)

data_path = '/kaggle/input/paddy-doctor-diseases-small/'
for filepath in glob.glob(data_path + '/*/'):
    files = glob.glob(filepath + '*')
    print(f"{len(files)} \t {Path(filepath).name}")

meta = pd.read_csv(os.path.join(data_path, 'metadata.csv'))
meta.head()

# ## distribution of labels
# meta.groupby('label')['label'].count().sort_values().plot.barh(figsize=(8,5))

# ## distribution of labels in percentage
# (meta.groupby('label')['label'].count().sort_values() / meta.shape[0] * 100).plot.barh(figsize=(8,5))

fig,ax = plt.subplots(figsize = (10, 6))
sns.countplot(y = 'label',
              data = meta,
              order = meta['label'].value_counts().index)
plt.show()
print(meta["label"].value_counts())

fig,ax = plt.subplots(figsize = (10, 6))
sns.countplot(y = 'variety',
              data = meta,
              order = meta['variety'].value_counts().index)
plt.show()
print(meta["variety"].value_counts())

fig,ax = plt.subplots(figsize = (10, 6))
sns.countplot(y = 'age',
              data = meta,
              order = meta['age'].value_counts().index)
plt.show()
print(meta["age"].value_counts())

sns.distplot(meta["age"])

fig,ax = plt.subplots(figsize = (12, 6))
ax.set_xticklabels(meta["label"].index, rotation = 30)
ax.set_title("Labels age distribution")
sns.violinplot(x = "label", y = "age", data = meta)
plt.show()

fig,ax = plt.subplots(figsize = (12, 6))
ax.set_xticklabels(meta["label"].index, rotation = 30)
sns.countplot(x = "label", hue = "variety", data = meta)

# fig, ax = plt.subplots(nrows = 3, ncols = 1, figsize = (14, 18))
# ax[0].set_xticklabels(train_labels["label"].index, rotation = 30)
# sns.countplot(x = "label", hue = "variety", data = train_labels, ax = ax[0])
# sns.countplot(x = "label", hue = "variety", data = train_labels_rare, ax = ax[1])
# sns.violinplot(x = "variety", y = "age", ax = ax[2], data = train_labels)

# plt.tight_layout()
# plt.show()